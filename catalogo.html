<!-- catalogo.html: P√°gina del cat√°logo principal del Vivero Nuevo Renacer -->
<!DOCTYPE html>
<html lang="es">
<head>

  <!-- Configuraci√≥n base de caracteres y vista responsive -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- T√≠tulo que se ver√° en la pesta√±a del navegador -->
  <title>Cat√°logo - Vivero Nuevo Renacer</title>

   <!-- Icono de favicon -->
   <link rel="icon" type="image/png" href="images/iconoviveroo.png">
   
  <!-- Bootstrap, iconos y hojas de estilo espec√≠ficas del sitio y del cat√°logo -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="css/estilos.css" rel="stylesheet">
  <link href="css/catalogo.css" rel="stylesheet">
</head>
<body>

  <!-- Navbar -->
  <!-- Barra de navegaci√≥n superior compartida con el resto de p√°ginas -->
  <nav class="navbar navbar-expand-lg navbar-dark shadow-sm">
  <div class="container">
    <!-- Marca del vivero (logo + texto) que redirige al inicio -->
    <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
      <img
        src="images/iconovivero.png"
        alt="Vivero Nuevo Renacer"
        class="brand-logo"
        loading="eager"
        decoding="async"
      />
      <span>Vivero Nuevo Renacer</span>
    </a>

    <!-- Bot√≥n hamburguesa para mostrar/ocultar men√∫ en m√≥viles -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarNav" aria-controls="navbarNav"
            aria-expanded="false" aria-label="Mostrar navegaci√≥n">
      <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Enlaces de la navegaci√≥n -->
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">
        <!-- Link a la p√°gina de inicio -->
        <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
        <!-- Link actual (Cat√°logo) marcado como activo -->
        <li class="nav-item"><a class="nav-link active" href="catalogo.html">Cat√°logo</a></li>
        <!-- Enlaces que hacen scroll a secciones del inicio -->
        <li class="nav-item"><a class="nav-link" href="index.html#contacto">Contacto</a></li>
        <li class="nav-item"><a class="nav-link" href="index.html#ubicacion">Ubicaci√≥n</a></li>

        <!-- Carrito (pen√∫ltimo) -->
        <!-- Bot√≥n que abre el panel offcanvas del carrito -->
        <li class="nav-item">
          <button class="btn btn-light position-relative"
                  data-bs-toggle="offcanvas" data-bs-target="#offcanvasCart" aria-controls="offcanvasCart">
            <i class="bi bi-bag"></i>
            <!-- Badge con el contador de √≠tems en el carrito -->
            <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
          </button>
        </li>

        <!-- Botones si NO hay sesi√≥n -->
        <!-- Secci√≥n que muestra "Iniciar sesi√≥n / Registrarse" cuando el usuario no est√° logueado -->
        <li id="nav-auth-only" class="nav-item d-flex gap-2">
          <a class="btn btn-light" href="login.html">Iniciar sesi√≥n</a>
          <a class="btn btn-outline-light" href="registro.html">Registrarse</a>
        </li>

        <!-- Perfil (√∫ltimo a la derecha) | orden: icono ‚Üí nombre ‚Üí flecha -->
        <!-- Men√∫ de perfil que solo se muestra cuando s√≠ hay sesi√≥n -->
        <li id="nav-profile" class="nav-item dropdown d-none ms-lg-2">
          <a class="nav-link dropdown-toggle no-caret d-flex align-items-center gap-2 nav-profile-trigger"
             href="#" role="button"
             data-bs-toggle="dropdown"
             data-bs-display="static"
             aria-expanded="false">
            <i class="bi bi-person-circle fs-5"></i>
            <!-- Aqu√≠ pinto el nombre del usuario desde JS cuando est√° logueado -->
            <span id="nav-username" class="d-none d-lg-inline">Mi perfil</span>
            <i class="bi bi-caret-down-fill"></i>
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <!-- Link al perfil del usuario -->
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="perfil.html">
                <i class="bi bi-person-gear"></i> Mi perfil
              </a>
            </li>
            
            <!-- Link a la wishlist/favoritos -->
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="wishlist.html">
                <i class="bi bi-heart"></i> Mis favoritos
              </a>
            </li>
            <!-- Panel administrador, lo muestro s√≥lo si el usuario tiene rol admin (controlado con JS) -->
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2 d-none" id="nav-admin" href="admin.html">
                <i class="bi bi-speedometer2"></i> Panel administrador
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <!-- Bot√≥n para cerrar sesi√≥n -->
            <li>
              <button class="dropdown-item text-danger d-flex align-items-center gap-2" id="btn-logout" type="button">
                <i class="bi bi-box-arrow-right"></i> Cerrar sesi√≥n
              </button>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
  <!-- Fin Navbar -->

  <!-- Migas -->
  <!-- Breadcrumb para indicar al usuario en qu√© parte del sitio est√° -->
  <nav class="container mt-3" aria-label="breadcrumb">
    <ol class="breadcrumb small">
      <li class="breadcrumb-item"><a href="index.html">Inicio</a></li>
      <li class="breadcrumb-item active" aria-current="page">Cat√°logo</li>
    </ol>
  </nav>

  <!-- Toolbar -->
  <!-- Barra de herramientas del cat√°logo: b√∫squeda, vista y ordenamiento -->
  <section class="container my-3">
    <div class="catalog-toolbar d-flex flex-column flex-lg-row align-items-stretch align-items-lg-center gap-3">
      <!-- Buscador principal del cat√°logo -->
      <div class="flex-grow-1 position-relative">
        <i class="bi bi-search position-absolute top-50 translate-middle-y ms-3"></i>
        <!-- Input de b√∫squeda por nombre/palabras clave -->
        <input id="searchInput" type="search" class="form-control ps-5" placeholder="Buscar plantas (ej. agucate, cacao, pino)..." aria-label="Buscar en cat√°logo">
      </div>

      <div class="d-flex align-items-center gap-2">
        <!-- Botones para cambiar entre vista grid/lista (solo en pantallas grandes) -->
        <div class="d-none d-lg-flex align-items-center gap-2">
          <span class="text-muted small">Vista:</span>
          <div class="btn-group view-toggle" role="group" aria-label="Cambiar vista">
            <button class="btn btn-outline-success btn-sm active" id="btnGrid" title="Grid"><i class="bi bi-grid"></i></button>
            <button class="btn btn-outline-success btn-sm" id="btnList" title="Lista"><i class="bi bi-list"></i></button>
          </div>
        </div>

        <!-- Selector para ordenar resultados -->
        <div class="d-flex align-items-center gap-2">
          <label for="sortSelect" class="text-muted small mb-0">Ordenar:</label>
          <select id="sortSelect" class="form-select form-select-sm">
            <option value="relevance">Relevancia</option>
            <option value="price-asc">Precio: menor a mayor</option>
            <option value="price-desc">Precio: mayor a menor</option>
            <option value="name-asc">Nombre: A ‚Üí Z</option>
            <option value="name-desc">Nombre: Z ‚Üí A</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Contenedor donde se ver√°n los filtros activos y el conteo de resultados -->
    <div class="d-flex flex-wrap align-items-center gap-2 mt-2">
      <!-- Aqu√≠ pinto los chips de filtros activos desde JS -->
      <div id="activeFilters" class="d-flex flex-wrap gap-2"></div>
      <!-- Total de resultados que se est√°n mostrando -->
      <span class="ms-auto small text-muted"><span id="resultCount">0</span> resultados</span>
    </div>
  </section>

  <div class="container my-4">
    <div class="row g-4">
      <!-- Sidebar de filtros (solo en pantallas grandes) -->
      <aside class="col-lg-3 d-none d-lg-block">
        <div class="sidebar-sticky p-3 rounded-4 shadow-sm bg-white">
          <h6 class="fw-bold mb-3">Filtros</h6>

          <!-- Filtro por categor√≠as, se rellena din√°micamente -->
          <div class="mb-3">
            <div class="fw-semibold mb-2">Categor√≠as</div>
            <div id="categoryFilters" class="d-grid gap-1"></div>
          </div>

          <!-- Filtros por rango de precio -->
          <div class="mb-3">
            <div class="fw-semibold mb-2">Precio</div>
            <div class="d-flex align-items-center gap-2">
              <!-- Precio m√≠nimo -->
              <input type="number" id="priceMin" class="form-control form-control-sm" placeholder="M√≠n." min="0">
              <span class="text-muted small">‚Äî</span>
              <!-- Precio m√°ximo -->
              <input type="number" id="priceMax" class="form-control form-control-sm" placeholder="M√°x." min="0">
            </div>
            <!-- Bot√≥n para aplicar el rango de precios -->
            <button id="applyPrice" class="btn btn-outline-success btn-sm mt-2 w-100">Aplicar</button>
          </div>

          <!-- Bot√≥n para limpiar todos los filtros aplicados -->
          <button id="clearAll" class="btn btn-link text-danger p-0 small">Limpiar filtros</button>
        </div>
      </aside>

      <!-- Zona principal donde se pintan las tarjetas del cat√°logo -->
      <main class="col-lg-9">
        <!-- Aqu√≠ JS genera el grid/lista de productos -->
        <div id="productGrid" class="row g-3"></div>
        <noscript><p>Activa JavaScript para ver el cat√°logo din√°mico.</p></noscript>
      </main>
    </div>
  </div>

  <!-- Quick View -->
  <!-- Modal de vista r√°pida (variante 1) para mostrar un producto sin salir del cat√°logo -->
  <div class="modal fade" id="quickViewModal" tabindex="-1" aria-labelledby="quickViewLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-body p-0">
          <div class="row g-0">
            <!-- Columna de la imagen del producto -->
            <div class="col-md-6">
              <img id="qvImg" src="" alt="" class="w-100 h-100 object-fit-cover" style="max-height:420px;">
            </div>
            <!-- Columna de la informaci√≥n del producto -->
            <div class="col-md-6 p-4">
              <h5 id="qvTitle" class="mb-1"></h5>
              <p id="qvTags" class="text-muted small mb-3"></p>
              <div class="d-flex align-items-center gap-2 mb-3">
                <strong id="qvPrice" class="fs-5 text-success"></strong>
                <span id="qvOldPrice" class="text-decoration-line-through text-muted"></span>
              </div>
              <p id="qvDesc" class="small"></p>
              <div class="d-grid gap-2 mt-3">
                <!-- Bot√≥n para a√±adir al carrito desde la vista r√°pida -->
                <button id="qvAdd" class="btn btn-custom">
                  <i class="bi bi-cart-plus"></i> A√±adir al carrito
                </button>
                <!-- Bot√≥n para cerrar el modal -->
                <button class="btn btn-outline-secondary" data-bs-dismiss="modal">Cerrar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Offcanvas Carrito -->
  <!-- Panel lateral (offcanvas) donde se listan los productos del carrito -->
 <div class="offcanvas offcanvas-end"
     tabindex="-1"
     id="offcanvasCart"
     aria-labelledby="offcanvasCartLabel"
     data-bs-scroll="true"
     data-bs-backdrop="false">
    <div class="offcanvas-header">
      <h5 id="offcanvasCartLabel" class="mb-0">Tu carrito</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
    </div>
    <div class="offcanvas-body">
      <!-- Lista de productos en el carrito (se llena con JS) -->
      <ul id="cart-list" class="list-group mb-3"></ul>
      <div class="d-flex justify-content-between align-items-center">
        <strong>Total:</strong> <span id="cart-total">$0</span>
      </div>
      <hr>
      <!-- Bot√≥n para armar y enviar el pedido por WhatsApp con los √≠tems del carrito -->
     <button id="btnCartWhatsApp"
        class="btn btn-custom w-100"
        type="button"
        data-phone="+57 321 926 1465">
  <i class="bi bi-whatsapp me-2"></i>Enviar pedido por WhatsApp
</button>

    </div>
  </div>

  <!-- Toast -->
  <!-- Notificaci√≥n flotante que uso cuando se a√±ade un producto al carrito -->
  <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1100;">
    <div id="toast-added" class="toast align-items-center border-0" role="status" aria-live="polite" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">Producto a√±adido al carrito. üåø</div>
        <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
    </div>
  </div>

  <!-- Modal ‚Äúrequiere sesi√≥n‚Äù -->
  <!-- Modal que bloqueo acciones (como carrito/favoritos) si el usuario no ha iniciado sesi√≥n -->
  <div class="modal fade" id="authGateModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content shadow-lg border-0 rounded-4">
        <div class="modal-header border-0">
          <h5 class="modal-title">¬°Bienvenido! üëã</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body pt-0">
          <p class="mb-3">Para usar <strong>favoritos</strong> y el <strong>carrito</strong> necesitas iniciar sesi√≥n.</p>
          <div class="d-grid gap-2">
            <a href="login.html" class="btn btn-success">Iniciar sesi√≥n</a>
            <a href="registro.html" class="btn btn-outline-success">Crear cuenta</a>
          </div>
        </div>
      </div>
    </div>
  </div>

 <!-- Scripts -->
 <!-- JS de Bootstrap para manejar modales, offcanvas, toasts, etc. -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- primero helpers globales -->
<!-- app.js maneja cosas globales como navbar, auth, carrito compartido, etc. -->
<script src="js/app.js?v=navbar-fix"></script>

<!-- luego el cat√°logo -->
<!-- catalogo.js se encarga de la l√≥gica de filtros, b√∫squeda, render de productos, quick view, etc. -->
<script src="js/catalogo.js?v=navbar-fix"></script>


  <!-- Quick View Modal -->
  <!-- Segunda variante de modal de vista r√°pida (estructura alternativa) -->
<div class="modal fade" id="quickView" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content shadow-lg rounded-4 overflow-hidden">
      <!-- Bot√≥n de cierre flotante en la esquina -->
      <button type="button" class="btn-close position-absolute top-0 end-0 m-3 z-3"
              data-bs-dismiss="modal" aria-label="Cerrar"></button>

      <div class="row g-0">
        <!-- Col izquierda: imagen del producto -->
        <div class="col-lg-5 bg-light d-flex align-items-center justify-content-center p-3">
          <img id="qvImage" src="images/monstera.jpg" alt="Vista r√°pida" class="img-fluid rounded object-fit-cover" style="max-height: 360px; width: 100%;"/>
        </div>

        <!-- Col derecha: informaci√≥n del producto -->
        <div class="col-lg-7 p-4">
          <h5 id="qvName" class="mb-1">Nombre de la planta</h5>
          <div id="qvCategory" class="text-muted small mb-2">Categor√≠a</div>
          <div id="qvPrice" class="h5 text-success mb-3">$ 0</div>

          <p id="qvDesc" class="mb-3 text-body-secondary" style="max-height: 140px; overflow:auto;">
            Descripci√≥n de la planta‚Ä¶
          </p>

          <!-- Controles para cantidad y a√±adir al carrito desde la vista r√°pida -->
          <div class="d-flex align-items-center gap-2">
            <input id="qvQty" type="number" class="form-control" value="1" min="1" step="1" style="max-width: 110px;">
            <button id="qvAdd" class="btn btn-success">
              <i class="bi bi-bag-plus"></i> A√±adir al carrito
            </button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

</body>
</html>
